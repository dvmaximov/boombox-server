import{c as ue,r as R,d as f,h as s,an as X,j as Y,$ as Rt,A as xe,K as re,aj as Ze,w as U,_ as Ve,C as z,N as ne,F as k,E as O,M as B,L as N,I as xt,e as he,g as Vt,Q as De,aL as Dt,aM as Tt,z as Ot,a5 as jt,aQ as Et,k as It,o as Lt,a4 as Ue,aR as Be,aS as He,aI as At,n as et,aT as Nt,B as Re,R as Mt,ay as Qt,az as Ut,D as ze,H as Ke,m as Ht,aK as zt,ak as Kt}from"./index.91eefe89.js";import{c as Wt,b as $e,a as tt}from"./QCheckbox.9829003a.js";import{d as Gt,a as Jt,e as Xt,g as Yt,h as Zt,k as el,i as We,f as tl,Q as Te}from"./QInput.1ddde6c1.js";import{u as ll,a as al,b as ol}from"./use-file.6683a2fe.js";import{h as nl}from"./format.7c5c042c.js";import{u as lt,Q as at}from"./QImg.60357969.js";import{Q as rl}from"./QPage.2de8739d.js";import{j as ot}from"./message.store.1c2f16ed.js";import{u as Oe}from"./image-categories.store.080d3b9c.js";import{Q as nt,g as ul}from"./QVirtualScroll.a65332a5.js";import{Q as sl,a as il}from"./QCard.39bb05b2.js";import{Q as cl}from"./QDialog.a374c685.js";import{Q as dl}from"./QSeparator.7a1918a7.js";import{u as rt,a as ut}from"./use-dark.fe45a380.js";import{c as st}from"./use-virtual-scroll.ea3793eb.js";import{C as vl}from"./ConfirmDialog.c8d65c27.js";import"./QItem.c4b6ed33.js";import"./position-engine.df28c415.js";import"./focus-manager.05708ea9.js";import"./settings.store.a1ab846d.js";import"./use-quasar.c8bf5230.js";import"./QList.34eed757.js";import"./QCardActions.782252e4.js";var fl=ue({name:"QFile",inheritAttrs:!1,props:{...Gt,...Jt,...ll,modelValue:[File,FileList,Array],append:Boolean,useChips:Boolean,displayValue:[String,Number],tabindex:{type:[String,Number],default:0},counterLabel:Function,inputClass:[Array,String,Object],inputStyle:[Array,String,Object]},emits:[...Xt,...al],setup(e,{slots:l,emit:a,attrs:v}){const{proxy:u}=Y(),i=Yt(),o=R(null),r=R(!1),c=Zt(e),{pickFiles:g,onDragover:n,onDragleave:y,processFiles:_,getDndNode:q}=ol({editable:i.editable,dnd:r,getFileInput:se,addFilesToQueue:te}),p=el(e),m=f(()=>Object(e.modelValue)===e.modelValue?"length"in e.modelValue?Array.from(e.modelValue):[e.modelValue]:[]),C=f(()=>We(m.value)),j=f(()=>m.value.map(S=>S.name).join(", ")),M=f(()=>nl(m.value.reduce((S,V)=>S+V.size,0))),E=f(()=>({totalSize:M.value,filesNumber:m.value.length,maxFiles:e.maxFiles})),$=f(()=>({tabindex:-1,type:"file",title:"",accept:e.accept,capture:e.capture,name:c.value,...v,id:i.targetUid.value,disabled:i.editable.value!==!0})),x=f(()=>"q-file q-field--auto-height"+(r.value===!0?" q-file--dnd":"")),H=f(()=>e.multiple===!0&&e.append===!0);function Z(S){const V=m.value.slice();V.splice(S,1),K(V)}function ee(S){const V=m.value.indexOf(S);V>-1&&Z(V)}function K(S){a("update:modelValue",e.multiple===!0?S:S[0])}function L(S){S.keyCode===13&&Rt(S)}function Q(S){(S.keyCode===13||S.keyCode===32)&&g(S)}function se(){return o.value}function te(S,V){const D=_(S,V,m.value,H.value),ae=se();ae!=null&&(ae.value=""),D!==void 0&&((e.multiple===!0?e.modelValue&&D.every(I=>m.value.includes(I)):e.modelValue===D[0])||K(H.value===!0?m.value.concat(D):D))}function W(){return[s("input",{class:[e.inputClass,"q-file__filler"],style:e.inputStyle})]}function ie(){if(l.file!==void 0)return m.value.length===0?W():m.value.map((V,D)=>l.file({index:D,file:V,ref:this}));if(l.selected!==void 0)return m.value.length===0?W():l.selected({files:m.value,ref:this});if(e.useChips===!0)return m.value.length===0?W():m.value.map((V,D)=>s(Wt,{key:"file-"+D,removable:i.editable.value,dense:!0,textColor:e.color,tabindex:e.tabindex,onRemove:()=>{Z(D)}},()=>s("span",{class:"ellipsis",textContent:V.name})));const S=e.displayValue!==void 0?e.displayValue:j.value;return S.length!==0?[s("div",{class:e.inputClass,style:e.inputStyle,textContent:S})]:W()}function le(){const S={ref:o,...$.value,...p.value,class:"q-field__input fit absolute-full cursor-pointer",onChange:te};return e.multiple===!0&&(S.multiple=!0),s("input",S)}return Object.assign(i,{fieldClass:x,emitValue:K,hasValue:C,inputRef:o,innerValue:m,floatingLabel:f(()=>C.value===!0||We(e.displayValue)),computedCounter:f(()=>{if(e.counterLabel!==void 0)return e.counterLabel(E.value);const S=e.maxFiles;return`${m.value.length}${S!==void 0?" / "+S:""} (${M.value})`}),getControlChild:()=>q("file"),getControl:()=>{const S={ref:i.targetRef,class:"q-field__native row items-center cursor-pointer",tabindex:e.tabindex};return i.editable.value===!0&&Object.assign(S,{onDragover:n,onDragleave:y,onKeydown:L,onKeyup:Q}),s("div",S,[le()].concat(ie()))}}),Object.assign(u,{removeAtIndex:Z,removeFile:ee,getNativeElement:()=>o.value}),X(u,"nativeEl",()=>o.value),tl(i)}});const ml=xe({name:"ImageCategoryAdd",props:{isShow:{type:Boolean,default:!1}},setup(e,l){const a=Oe(),v=ot(),{categoriesList:u}=re(a),i=Ze(()=>e.isShow),o=R("");return U(i,g=>{g&&(o.value="")}),{categoriesList:u,show:i,name:o,close:()=>{l.emit("close")},save:async()=>{if(o.value===""){v.error("\u0418\u043C\u044F \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u0438 \u043D\u0435 \u043C\u043E\u0436\u0435\u0442 \u0431\u044B\u0442\u044C \u043F\u0443\u0441\u0442\u044B\u043C!");return}const g=await a.insert({record:{name:o.value}});console.log(g)}}}}),gl={class:"q-pa-md q-gutter-sm"},bl={class:"flex justify-between items-center"},yl={class:"q-mt-sm q-pa-sm item",dense:"",clickable:""},hl={class:"flex justify-between items-center"},Sl={class:"flex justify-center items-center q-ma-md"};function wl(e,l,a,v,u,i){return z(),ne("div",gl,[k(cl,{modelValue:e.show,"onUpdate:modelValue":l[1]||(l[1]=o=>e.show=o),persistent:""},{default:O(()=>[k(sl,null,{default:O(()=>[k(il,null,{default:O(()=>[B("div",bl,[k(Te,{outlined:"",autofocus:"",label:"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u044E",modelValue:e.name,"onUpdate:modelValue":l[0]||(l[0]=o=>e.name=o),style:{padding:"0"}},null,8,["modelValue"]),k(N,{class:"q-ml-md",round:"",color:"primary",label:">",onClick:e.save},null,8,["onClick"])]),k(nt,{style:{height:"300px"},class:"q-px-md",items:e.categoriesList,separator:""},{default:O(({item:o})=>[B("div",yl,[B("div",hl,[B("div",null,xt(o.name),1)])])]),_:1},8,["items"])]),_:1}),B("div",Sl,[k(N,{label:"\u041E\u0442\u043C\u0435\u043D\u0430",color:"primary",onClick:e.close},null,8,["onClick"])])]),_:1})]),_:1},8,["modelValue"])])}var Cl=Ve(ml,[["render",wl],["__scopeId","data-v-18db3cbb"]]),Ge=ue({name:"QTd",props:{props:Object,autoWidth:Boolean,noHover:Boolean},setup(e,{slots:l}){const a=Y(),v=f(()=>"q-td"+(e.autoWidth===!0?" q-table--col-auto-width":"")+(e.noHover===!0?" q-td--no-hover":"")+" ");return()=>{if(e.props===void 0)return s("td",{class:v.value},he(l.default));const u=a.vnode.key,i=(e.props.colsMap!==void 0?e.props.colsMap[u]:null)||e.props.col;if(i===void 0)return;const{row:o}=e.props;return s("td",{class:v.value+i.__tdClass(o),style:i.__tdStyle(o)},he(l.default))}}}),_l=ue({name:"QTh",props:{props:Object,autoWidth:Boolean},emits:["click"],setup(e,{slots:l,emit:a}){const v=Y(),{proxy:{$q:u}}=v,i=o=>{a("click",o)};return()=>{if(e.props===void 0)return s("th",{class:e.autoWidth===!0?"q-table--col-auto-width":"",onClick:i},he(l.default));let o,r;const c=v.vnode.key;if(c){if(o=e.props.colsMap[c],o===void 0)return}else o=e.props.col;if(o.sortable===!0){const n=o.align==="right"?"unshift":"push";r=Vt(l.default,[]),r[n](s(De,{class:o.__iconClass,name:u.iconSet.table.arrowUp}))}else r=he(l.default);const g={class:o.__thClass+(e.autoWidth===!0?" q-table--col-auto-width":""),style:o.headerStyle,onClick:n=>{o.sortable===!0&&e.props.sort(o),i(n)}};return s("th",g,r)}}});const pl={xs:2,sm:4,md:6,lg:10,xl:14};function Je(e,l,a){return{transform:l===!0?`translateX(${a.lang.rtl===!0?"-":""}100%) scale3d(${-e},1,1)`:`scale3d(${e},1,1)`}}var ql=ue({name:"QLinearProgress",props:{...rt,...Dt,value:{type:Number,default:0},buffer:Number,color:String,trackColor:String,reverse:Boolean,stripe:Boolean,indeterminate:Boolean,query:Boolean,rounded:Boolean,animationSpeed:{type:[String,Number],default:2100},instantFeedback:Boolean},setup(e,{slots:l}){const{proxy:a}=Y(),v=ut(e,a.$q),u=Tt(e,pl),i=f(()=>e.indeterminate===!0||e.query===!0),o=f(()=>e.reverse!==e.query),r=f(()=>({...u.value!==null?u.value:{},"--q-linear-progress-speed":`${e.animationSpeed}ms`})),c=f(()=>"q-linear-progress"+(e.color!==void 0?` text-${e.color}`:"")+(e.reverse===!0||e.query===!0?" q-linear-progress--reverse":"")+(e.rounded===!0?" rounded-borders":"")),g=f(()=>Je(e.buffer!==void 0?e.buffer:1,o.value,a.$q)),n=f(()=>`with${e.instantFeedback===!0?"out":""}-transition`),y=f(()=>`q-linear-progress__track absolute-full q-linear-progress__track--${n.value} q-linear-progress__track--${v.value===!0?"dark":"light"}`+(e.trackColor!==void 0?` bg-${e.trackColor}`:"")),_=f(()=>Je(i.value===!0?1:e.value,o.value,a.$q)),q=f(()=>`q-linear-progress__model absolute-full q-linear-progress__model--${n.value} q-linear-progress__model--${i.value===!0?"in":""}determinate`),p=f(()=>({width:`${e.value*100}%`})),m=f(()=>`q-linear-progress__stripe absolute-${e.reverse===!0?"right":"left"} q-linear-progress__stripe--${n.value}`);return()=>{const C=[s("div",{class:y.value,style:g.value}),s("div",{class:q.value,style:_.value})];return e.stripe===!0&&i.value===!1&&C.push(s("div",{class:m.value,style:p.value})),s("div",{class:c.value,style:r.value,role:"progressbar","aria-valuemin":0,"aria-valuemax":1,"aria-valuenow":e.indeterminate===!0?void 0:e.value},Ot(l.default,C))}}});let oe=0;const Pl={fullscreen:Boolean,noRouteFullscreenExit:Boolean},kl=["update:fullscreen","fullscreen"];function Fl(){const e=Y(),{props:l,emit:a,proxy:v}=e;let u,i,o;const r=R(!1);jt(e)===!0&&U(()=>v.$route.fullPath,()=>{l.noRouteFullscreenExit!==!0&&n()}),U(()=>l.fullscreen,y=>{r.value!==y&&c()}),U(r,y=>{a("update:fullscreen",y),a("fullscreen",y)});function c(){r.value===!0?n():g()}function g(){r.value!==!0&&(r.value=!0,o=v.$el.parentNode,o.replaceChild(i,v.$el),document.body.appendChild(v.$el),oe++,oe===1&&document.body.classList.add("q-body--fullscreen-mixin"),u={handler:n},Ue.add(u))}function n(){r.value===!0&&(u!==void 0&&(Ue.remove(u),u=void 0),o.replaceChild(v.$el,i),r.value=!1,oe=Math.max(0,oe-1),oe===0&&(document.body.classList.remove("q-body--fullscreen-mixin"),v.$el.scrollIntoView!==void 0&&setTimeout(()=>{v.$el.scrollIntoView()})))}return Et(()=>{i=document.createElement("span")}),It(()=>{l.fullscreen===!0&&g()}),Lt(n),Object.assign(v,{toggleFullscreen:c,setFullscreen:g,exitFullscreen:n}),{inFullscreen:r,toggleFullscreen:c}}function $l(e,l){return new Date(e)-new Date(l)}const Bl={sortMethod:Function,binaryStateSort:Boolean,columnSortOrder:{type:String,validator:e=>e==="ad"||e==="da",default:"ad"}};function Rl(e,l,a,v){const u=f(()=>{const{sortBy:r}=l.value;return r&&a.value.find(c=>c.name===r)||null}),i=f(()=>e.sortMethod!==void 0?e.sortMethod:(r,c,g)=>{const n=a.value.find(q=>q.name===c);if(n===void 0||n.field===void 0)return r;const y=g===!0?-1:1,_=typeof n.field=="function"?q=>n.field(q):q=>q[n.field];return r.sort((q,p)=>{let m=_(q),C=_(p);return m==null?-1*y:C==null?1*y:n.sort!==void 0?n.sort(m,C,q,p)*y:Be(m)===!0&&Be(C)===!0?(m-C)*y:He(m)===!0&&He(C)===!0?$l(m,C)*y:typeof m=="boolean"&&typeof C=="boolean"?(m-C)*y:([m,C]=[m,C].map(j=>(j+"").toLocaleString().toLowerCase()),m<C?-1*y:m===C?0:y)})});function o(r){let c=e.columnSortOrder;if(At(r)===!0)r.sortOrder&&(c=r.sortOrder),r=r.name;else{const y=a.value.find(_=>_.name===r);y!==void 0&&y.sortOrder&&(c=y.sortOrder)}let{sortBy:g,descending:n}=l.value;g!==r?(g=r,n=c==="da"):e.binaryStateSort===!0?n=!n:n===!0?c==="ad"?g=null:n=!1:c==="ad"?n=!0:g=null,v({sortBy:g,descending:n,page:1})}return{columnToSort:u,computedSortMethod:i,sort:o}}const xl={filter:[String,Object],filterMethod:Function};function Vl(e,l){const a=f(()=>e.filterMethod!==void 0?e.filterMethod:(v,u,i,o)=>{const r=u?u.toLowerCase():"";return v.filter(c=>i.some(g=>{const n=o(g,c)+"";return(n==="undefined"||n==="null"?"":n.toLowerCase()).indexOf(r)!==-1}))});return U(()=>e.filter,()=>{et(()=>{l({page:1},!0)})},{deep:!0}),{computedFilterMethod:a}}function Dl(e,l){for(const a in l)if(l[a]!==e[a])return!1;return!0}function Xe(e){return e.page<1&&(e.page=1),e.rowsPerPage!==void 0&&e.rowsPerPage<1&&(e.rowsPerPage=0),e}const Tl={pagination:Object,rowsPerPageOptions:{type:Array,default:()=>[5,7,10,15,20,25,50,0]},"onUpdate:pagination":[Function,Array]};function Ol(e,l){const{props:a,emit:v}=e,u=R(Object.assign({sortBy:null,descending:!1,page:1,rowsPerPage:a.rowsPerPageOptions.length!==0?a.rowsPerPageOptions[0]:5},a.pagination)),i=f(()=>{const n=a["onUpdate:pagination"]!==void 0?{...u.value,...a.pagination}:u.value;return Xe(n)}),o=f(()=>i.value.rowsNumber!==void 0);function r(n){c({pagination:n,filter:a.filter})}function c(n={}){et(()=>{v("request",{pagination:n.pagination||i.value,filter:n.filter||a.filter,getCellValue:l})})}function g(n,y){const _=Xe({...i.value,...n});if(Dl(i.value,_)===!0){o.value===!0&&y===!0&&r(_);return}if(o.value===!0){r(_);return}a.pagination!==void 0&&a["onUpdate:pagination"]!==void 0?v("update:pagination",_):u.value=_}return{innerPagination:u,computedPagination:i,isServerSide:o,requestServerInteraction:c,setPagination:g}}function jl(e,l,a,v,u,i){const{props:o,emit:r,proxy:{$q:c}}=e,g=f(()=>v.value===!0?a.value.rowsNumber||0:i.value),n=f(()=>{const{page:$,rowsPerPage:x}=a.value;return($-1)*x}),y=f(()=>{const{page:$,rowsPerPage:x}=a.value;return $*x}),_=f(()=>a.value.page===1),q=f(()=>a.value.rowsPerPage===0?1:Math.max(1,Math.ceil(g.value/a.value.rowsPerPage))),p=f(()=>y.value===0?!0:a.value.page>=q.value),m=f(()=>(o.rowsPerPageOptions.includes(l.value.rowsPerPage)?o.rowsPerPageOptions:[l.value.rowsPerPage].concat(o.rowsPerPageOptions)).map(x=>({label:x===0?c.lang.table.allRows:""+x,value:x})));U(q,($,x)=>{if($===x)return;const H=a.value.page;$&&!H?u({page:1}):$<H&&u({page:$})});function C(){u({page:1})}function j(){const{page:$}=a.value;$>1&&u({page:$-1})}function M(){const{page:$,rowsPerPage:x}=a.value;y.value>0&&$*x<g.value&&u({page:$+1})}function E(){u({page:q.value})}return o["onUpdate:pagination"]!==void 0&&r("update:pagination",{...a.value}),{firstRowIndex:n,lastRowIndex:y,isFirstPage:_,isLastPage:p,pagesNumber:q,computedRowsPerPageOptions:m,computedRowsNumber:g,firstPage:C,prevPage:j,nextPage:M,lastPage:E}}const El={selection:{type:String,default:"none",validator:e=>["single","multiple","none"].includes(e)},selected:{type:Array,default:()=>[]}},Il=["update:selected","selection"];function Ll(e,l,a,v){const u=f(()=>{const p={};return e.selected.map(v.value).forEach(m=>{p[m]=!0}),p}),i=f(()=>e.selection!=="none"),o=f(()=>e.selection==="single"),r=f(()=>e.selection==="multiple"),c=f(()=>a.value.length!==0&&a.value.every(p=>u.value[v.value(p)]===!0)),g=f(()=>c.value!==!0&&a.value.some(p=>u.value[v.value(p)]===!0)),n=f(()=>e.selected.length);function y(p){return u.value[p]===!0}function _(){l("update:selected",[])}function q(p,m,C,j){l("selection",{rows:m,added:C,keys:p,evt:j});const M=o.value===!0?C===!0?m:[]:C===!0?e.selected.concat(m):e.selected.filter(E=>p.includes(v.value(E))===!1);l("update:selected",M)}return{hasSelectionMode:i,singleSelection:o,multipleSelection:r,allRowsSelected:c,someRowsSelected:g,rowsSelectedNumber:n,isRowSelected:y,clearSelection:_,updateSelection:q}}function Ye(e){return Array.isArray(e)?e.slice():[]}const Al={expanded:Array},Nl=["update:expanded"];function Ml(e,l){const a=R(Ye(e.expanded));U(()=>e.expanded,o=>{a.value=Ye(o)});function v(o){return a.value.includes(o)}function u(o){e.expanded!==void 0?l("update:expanded",o):a.value=o}function i(o,r){const c=a.value.slice(),g=c.indexOf(o);r===!0?g===-1&&(c.push(o),u(c)):g!==-1&&(c.splice(g,1),u(c))}return{isRowExpanded:v,setExpanded:u,updateExpanded:i}}const Ql={visibleColumns:Array};function Ul(e,l,a){const v=f(()=>{if(e.columns!==void 0)return e.columns;const r=e.rows[0];return r!==void 0?Object.keys(r).map(c=>({name:c,label:c.toUpperCase(),field:c,align:Be(r[c])?"right":"left",sortable:!0})):[]}),u=f(()=>{const{sortBy:r,descending:c}=l.value;return(e.visibleColumns!==void 0?v.value.filter(n=>n.required===!0||e.visibleColumns.includes(n.name)===!0):v.value).map(n=>{const y=n.align||"right",_=`text-${y}`;return{...n,align:y,__iconClass:`q-table__sort-icon q-table__sort-icon--${y}`,__thClass:_+(n.headerClasses!==void 0?" "+n.headerClasses:"")+(n.sortable===!0?" sortable":"")+(n.name===r?` sorted ${c===!0?"sort-desc":""}`:""),__tdStyle:n.style!==void 0?typeof n.style!="function"?()=>n.style:n.style:()=>null,__tdClass:n.classes!==void 0?typeof n.classes!="function"?()=>_+" "+n.classes:q=>_+" "+n.classes(q):()=>_}})}),i=f(()=>{const r={};return u.value.forEach(c=>{r[c.name]=c}),r}),o=f(()=>e.tableColspan!==void 0?e.tableColspan:u.value.length+(a.value===!0?1:0));return{colList:v,computedCols:u,computedColsMap:i,computedColspan:o}}const ye="q-table__bottom row items-center",it={};st.forEach(e=>{it[e]={}});var Hl=ue({name:"QTable",props:{rows:{type:Array,default:()=>[]},rowKey:{type:[String,Function],default:"id"},columns:Array,loading:Boolean,iconFirstPage:String,iconPrevPage:String,iconNextPage:String,iconLastPage:String,title:String,hideHeader:Boolean,grid:Boolean,gridHeader:Boolean,dense:Boolean,flat:Boolean,bordered:Boolean,square:Boolean,separator:{type:String,default:"horizontal",validator:e=>["horizontal","vertical","cell","none"].includes(e)},wrapCells:Boolean,virtualScroll:Boolean,virtualScrollTarget:{default:void 0},...it,noDataLabel:String,noResultsLabel:String,loadingLabel:String,selectedRowsLabel:Function,rowsPerPageLabel:String,paginationLabel:Function,color:{type:String,default:"grey-8"},titleClass:[String,Array,Object],tableStyle:[String,Array,Object],tableClass:[String,Array,Object],tableHeaderStyle:[String,Array,Object],tableHeaderClass:[String,Array,Object],cardContainerClass:[String,Array,Object],cardContainerStyle:[String,Array,Object],cardStyle:[String,Array,Object],cardClass:[String,Array,Object],hideBottom:Boolean,hideSelectedBanner:Boolean,hideNoData:Boolean,hidePagination:Boolean,onRowClick:Function,onRowDblclick:Function,onRowContextmenu:Function,...rt,...Pl,...Ql,...xl,...Tl,...Al,...El,...Bl},emits:["request","virtualScroll",...kl,...Nl,...Il],setup(e,{slots:l,emit:a}){const v=Y(),{proxy:{$q:u}}=v,i=ut(e,u),{inFullscreen:o,toggleFullscreen:r}=Fl(),c=f(()=>typeof e.rowKey=="function"?e.rowKey:t=>t[e.rowKey]),g=R(null),n=R(null),y=f(()=>e.grid!==!0&&e.virtualScroll===!0),_=f(()=>" q-table__card"+(i.value===!0?" q-table__card--dark q-dark":"")+(e.square===!0?" q-table--square":"")+(e.flat===!0?" q-table--flat":"")+(e.bordered===!0?" q-table--bordered":"")),q=f(()=>`q-table__container q-table--${e.separator}-separator column no-wrap`+(e.grid===!0?" q-table--grid":_.value)+(i.value===!0?" q-table--dark":"")+(e.dense===!0?" q-table--dense":"")+(e.wrapCells===!1?" q-table--no-wrap":"")+(o.value===!0?" fullscreen scroll":"")),p=f(()=>q.value+(e.loading===!0?" q-table--loading":""));U(()=>e.tableStyle+e.tableClass+e.tableHeaderStyle+e.tableHeaderClass+q.value,()=>{y.value===!0&&n.value!==null&&n.value.reset()});const{innerPagination:m,computedPagination:C,isServerSide:j,requestServerInteraction:M,setPagination:E}=Ol(v,G),{computedFilterMethod:$}=Vl(e,E),{isRowExpanded:x,setExpanded:H,updateExpanded:Z}=Ml(e,a),ee=f(()=>{let t=e.rows;if(j.value===!0||t.length===0)return t;const{sortBy:d,descending:b}=C.value;return e.filter&&(t=$.value(t,e.filter,I.value,G)),ct.value!==null&&(t=dt.value(e.rows===t?t.slice():t,d,b)),t}),K=f(()=>ee.value.length),L=f(()=>{let t=ee.value;if(j.value===!0)return t;const{rowsPerPage:d}=C.value;return d!==0&&(ce.value===0&&e.rows!==t?t.length>de.value&&(t=t.slice(0,de.value)):t=t.slice(ce.value,de.value)),t}),{hasSelectionMode:Q,singleSelection:se,multipleSelection:te,allRowsSelected:W,someRowsSelected:ie,rowsSelectedNumber:le,isRowSelected:S,clearSelection:V,updateSelection:D}=Ll(e,a,L,c),{colList:ae,computedCols:I,computedColsMap:je,computedColspan:Ee}=Ul(e,C,Q),{columnToSort:ct,computedSortMethod:dt,sort:Se}=Rl(e,C,ae,E),{firstRowIndex:ce,lastRowIndex:de,isFirstPage:we,isLastPage:Ce,pagesNumber:ve,computedRowsPerPageOptions:vt,computedRowsNumber:fe,firstPage:_e,prevPage:pe,nextPage:qe,lastPage:Pe}=jl(v,m,C,j,E,K),ft=f(()=>L.value.length===0),mt=f(()=>{const t={};return st.forEach(d=>{t[d]=e[d]}),t.virtualScrollItemSize===void 0&&(t.virtualScrollItemSize=e.dense===!0?28:48),t});function gt(){y.value===!0&&n.value.reset()}function bt(){if(e.grid===!0)return $t();const t=e.hideHeader!==!0?Me:null;if(y.value===!0){const b=l["top-row"],h=l["bottom-row"],w={default:F=>Le(F.item,l.body,F.index)};if(b!==void 0){const F=s("tbody",b({cols:I.value}));w.before=t===null?()=>F:()=>[t()].concat(F)}else t!==null&&(w.before=t);return h!==void 0&&(w.after=()=>s("tbody",h({cols:I.value}))),s(nt,{ref:n,class:e.tableClass,style:e.tableStyle,...mt.value,scrollTarget:e.virtualScrollTarget,items:L.value,type:"__qtable",tableColspan:Ee.value,onVirtualScroll:ht},w)}const d=[St()];return t!==null&&d.unshift(t()),ul({class:["q-table__middle scroll",e.tableClass],style:e.tableStyle},d)}function yt(t,d){if(n.value!==null){n.value.scrollTo(t,d);return}t=parseInt(t,10);const b=g.value.querySelector(`tbody tr:nth-of-type(${t+1})`);if(b!==null){const h=g.value.querySelector(".q-table__middle.scroll"),w=b.offsetTop-e.virtualScrollStickySizeStart,F=w<h.scrollTop?"decrease":"increase";h.scrollTop=w,a("virtualScroll",{index:t,from:0,to:m.value.rowsPerPage-1,direction:F})}}function ht(t){a("virtualScroll",t)}function Ie(){return[s(ql,{class:"q-table__linear-progress",color:e.color,dark:i.value,indeterminate:!0,trackColor:"transparent"})]}function Le(t,d,b){const h=c.value(t),w=S(h);if(d!==void 0)return d(Ae({key:h,row:t,pageIndex:b,__trClass:w?"selected":""}));const F=l["body-cell"],P=I.value.map(T=>{const ge=l[`body-cell-${T.name}`],be=ge!==void 0?ge:F;return be!==void 0?be(wt({key:h,row:t,pageIndex:b,col:T})):s("td",{class:T.__tdClass(t),style:T.__tdStyle(t)},G(T,t))});if(Q.value===!0){const T=l["body-selection"],ge=T!==void 0?T(Ct({key:h,row:t,pageIndex:b})):[s($e,{modelValue:w,color:e.color,dark:i.value,dense:e.dense,"onUpdate:modelValue":(be,Bt)=>{D([h],[t],be,Bt)}})];P.unshift(s("td",{class:"q-table--col-auto-width"},ge))}const A={key:h,class:{selected:w}};return e.onRowClick!==void 0&&(A.class["cursor-pointer"]=!0,A.onClick=T=>{a("RowClick",T,t,b)}),e.onRowDblclick!==void 0&&(A.class["cursor-pointer"]=!0,A.onDblclick=T=>{a("RowDblclick",T,t,b)}),e.onRowContextmenu!==void 0&&(A.class["cursor-pointer"]=!0,A.onContextmenu=T=>{a("RowContextmenu",T,t,b)}),s("tr",A,P)}function St(){const t=l.body,d=l["top-row"],b=l["bottom-row"];let h=L.value.map((w,F)=>Le(w,t,F));return d!==void 0&&(h=d({cols:I.value}).concat(h)),b!==void 0&&(h=h.concat(b({cols:I.value}))),s("tbody",h)}function Ae(t){return ke(t),t.cols=t.cols.map(d=>X({...d},"value",()=>G(d,t.row))),t}function wt(t){return ke(t),X(t,"value",()=>G(t.col,t.row)),t}function Ct(t){return ke(t),t}function ke(t){Object.assign(t,{cols:I.value,colsMap:je.value,sort:Se,rowIndex:ce.value+t.pageIndex,color:e.color,dark:i.value,dense:e.dense}),Q.value===!0&&X(t,"selected",()=>S(t.key),(d,b)=>{D([t.key],[t.row],d,b)}),X(t,"expand",()=>x(t.key),d=>{Z(t.key,d)})}function G(t,d){const b=typeof t.field=="function"?t.field(d):d[t.field];return t.format!==void 0?t.format(b,d):b}const J=f(()=>({pagination:C.value,pagesNumber:ve.value,isFirstPage:we.value,isLastPage:Ce.value,firstPage:_e,prevPage:pe,nextPage:qe,lastPage:Pe,inFullscreen:o.value,toggleFullscreen:r}));function _t(){const t=l.top,d=l["top-left"],b=l["top-right"],h=l["top-selection"],w=Q.value===!0&&h!==void 0&&le.value>0,F="q-table__top relative-position row items-center";if(t!==void 0)return s("div",{class:F},[t(J.value)]);let P;if(w===!0?P=h(J.value).slice():(P=[],d!==void 0?P.push(s("div",{class:"q-table__control"},[d(J.value)])):e.title&&P.push(s("div",{class:"q-table__control"},[s("div",{class:["q-table__title",e.titleClass]},e.title)]))),b!==void 0&&(P.push(s("div",{class:"q-table__separator col"})),P.push(s("div",{class:"q-table__control"},[b(J.value)]))),P.length!==0)return s("div",{class:F},P)}const Ne=f(()=>ie.value===!0?null:W.value);function Me(){const t=pt();return e.loading===!0&&l.loading===void 0&&t.push(s("tr",{class:"q-table__progress"},[s("th",{class:"relative-position",colspan:Ee.value},Ie())])),s("thead",t)}function pt(){const t=l.header,d=l["header-cell"];if(t!==void 0)return t(Fe({header:!0})).slice();const b=I.value.map(h=>{const w=l[`header-cell-${h.name}`],F=w!==void 0?w:d,P=Fe({col:h});return F!==void 0?F(P):s(_l,{key:h.name,props:P},()=>h.label)});if(se.value===!0&&e.grid!==!0)b.unshift(s("th",{class:"q-table--col-auto-width"}," "));else if(te.value===!0){const h=l["header-selection"],w=h!==void 0?h(Fe({})):[s($e,{color:e.color,modelValue:Ne.value,dark:i.value,dense:e.dense,"onUpdate:modelValue":Qe})];b.unshift(s("th",{class:"q-table--col-auto-width"},w))}return[s("tr",{class:e.tableHeaderClass,style:e.tableHeaderStyle},b)]}function Fe(t){return Object.assign(t,{cols:I.value,sort:Se,colsMap:je.value,color:e.color,dark:i.value,dense:e.dense}),te.value===!0&&X(t,"selected",()=>Ne.value,Qe),t}function Qe(t){ie.value===!0&&(t=!1),D(L.value.map(c.value),L.value,t)}const me=f(()=>{const t=[e.iconFirstPage||u.iconSet.table.firstPage,e.iconPrevPage||u.iconSet.table.prevPage,e.iconNextPage||u.iconSet.table.nextPage,e.iconLastPage||u.iconSet.table.lastPage];return u.lang.rtl===!0?t.reverse():t});function qt(){if(e.hideBottom===!0)return;if(ft.value===!0){if(e.hideNoData===!0)return;const b=e.loading===!0?e.loadingLabel||u.lang.table.loading:e.filter?e.noResultsLabel||u.lang.table.noResults:e.noDataLabel||u.lang.table.noData,h=l["no-data"],w=h!==void 0?[h({message:b,icon:u.iconSet.table.warning,filter:e.filter})]:[s(De,{class:"q-table__bottom-nodata-icon",name:u.iconSet.table.warning}),b];return s("div",{class:ye+" q-table__bottom--nodata"},w)}const t=l.bottom;if(t!==void 0)return s("div",{class:ye},[t(J.value)]);const d=e.hideSelectedBanner!==!0&&Q.value===!0&&le.value>0?[s("div",{class:"q-table__control"},[s("div",[(e.selectedRowsLabel||u.lang.table.selectedRecords)(le.value)])])]:[];if(e.hidePagination!==!0)return s("div",{class:ye+" justify-end"},kt(d));if(d.length!==0)return s("div",{class:ye},d)}function Pt(t){E({page:1,rowsPerPage:t.value})}function kt(t){let d;const{rowsPerPage:b}=C.value,h=e.paginationLabel||u.lang.table.pagination,w=l.pagination,F=e.rowsPerPageOptions.length>1;if(t.push(s("div",{class:"q-table__separator col"})),F===!0&&t.push(s("div",{class:"q-table__control"},[s("span",{class:"q-table__bottom-item"},[e.rowsPerPageLabel||u.lang.table.recordsPerPage]),s(tt,{class:"q-table__select inline q-table__bottom-item",color:e.color,modelValue:b,options:vt.value,displayValue:b===0?u.lang.table.allRows:b,dark:i.value,borderless:!0,dense:!0,optionsDense:!0,optionsCover:!0,"onUpdate:modelValue":Pt})])),w!==void 0)d=w(J.value);else if(d=[s("span",b!==0?{class:"q-table__bottom-item"}:{},[b?h(ce.value+1,Math.min(de.value,fe.value),fe.value):h(1,K.value,fe.value)])],b!==0&&ve.value>1){const P={color:e.color,round:!0,dense:!0,flat:!0};e.dense===!0&&(P.size="sm"),ve.value>2&&d.push(s(N,{key:"pgFirst",...P,icon:me.value[0],disable:we.value,onClick:_e})),d.push(s(N,{key:"pgPrev",...P,icon:me.value[1],disable:we.value,onClick:pe}),s(N,{key:"pgNext",...P,icon:me.value[2],disable:Ce.value,onClick:qe})),ve.value>2&&d.push(s(N,{key:"pgLast",...P,icon:me.value[3],disable:Ce.value,onClick:Pe}))}return t.push(s("div",{class:"q-table__control"},d)),t}function Ft(){const t=e.gridHeader===!0?[s("table",{class:"q-table"},[Me()])]:e.loading===!0&&l.loading===void 0?Ie():void 0;return s("div",{class:"q-table__middle"},t)}function $t(){const t=l.item!==void 0?l.item:d=>{const b=d.cols.map(w=>s("div",{class:"q-table__grid-item-row"},[s("div",{class:"q-table__grid-item-title"},[w.label]),s("div",{class:"q-table__grid-item-value"},[w.value])]));if(Q.value===!0){const w=l["body-selection"],F=w!==void 0?w(d):[s($e,{modelValue:d.selected,color:e.color,dark:i.value,dense:e.dense,"onUpdate:modelValue":(P,A)=>{D([d.key],[d.row],P,A)}})];b.unshift(s("div",{class:"q-table__grid-item-row"},F),s(dl,{dark:i.value}))}const h={class:["q-table__grid-item-card"+_.value,e.cardClass],style:e.cardStyle};return(e.onRowClick!==void 0||e.onRowDblclick!==void 0)&&(h.class[0]+=" cursor-pointer",e.onRowClick!==void 0&&(h.onClick=w=>{a("RowClick",w,d.row,d.pageIndex)}),e.onRowDblclick!==void 0&&(h.onDblclick=w=>{a("RowDblclick",w,d.row,d.pageIndex)})),s("div",{class:"q-table__grid-item col-xs-12 col-sm-6 col-md-4 col-lg-3"+(d.selected===!0?" q-table__grid-item--selected":"")},[s("div",h,b)])};return s("div",{class:["q-table__grid-content row",e.cardContainerClass],style:e.cardContainerStyle},L.value.map((d,b)=>t(Ae({key:c.value(d),row:d,pageIndex:b}))))}return Object.assign(v.proxy,{requestServerInteraction:M,setPagination:E,firstPage:_e,prevPage:pe,nextPage:qe,lastPage:Pe,isRowSelected:S,clearSelection:V,isRowExpanded:x,setExpanded:H,sort:Se,resetVirtualScroll:gt,scrollTo:yt,getCellValue:G}),Nt(v.proxy,{filteredSortedRows:()=>ee.value,computedRows:()=>L.value,computedRowsNumber:()=>fe.value}),()=>{const t=[_t()],d={ref:g,class:p.value};return e.grid===!0?t.push(Ft()):Object.assign(d,{class:[d.class,e.cardClass],style:e.cardStyle}),t.push(bt(),qt()),e.loading===!0&&l.loading!==void 0&&t.push(l.loading()),s("div",d,t)}}});const zl=[{name:"content",required:!0,label:"\u0424\u043E\u0442\u043E",align:"left",field:e=>e.content,format:e=>`${e}`,sortable:!1},{name:"name",required:!0,label:"\u0418\u043C\u044F",align:"left",field:e=>e.name,format:e=>`${e}`,sortable:!1},{name:"category",required:!0,label:"\u041A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u044F",align:"left",field:e=>e.category,format:e=>`${e}`,sortable:!1},{name:"descriptor",required:!0,label:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C",align:"right",field:e=>e.descriptor,format:e=>`${e}`,sortable:!1}],Kl=xe({name:"ImagesList",components:{ConfirmDialog:vl},props:{category:{type:String,default:()=>""},showControls:{type:Boolean,default:!0},showCategory:{type:Boolean,default:!0}},setup(e){const l=lt(),a=Oe(),{categoryNames:v}=re(a),u=Ze(()=>e.category),i=R(!1),o=R(""),r=R(1),{images:c}=re(l),g=R(0),n=p=>{g.value=p,i.value=!0},y=async()=>{await l.removeImage(g.value),_()},_=()=>{i.value=!1,g.value=0};return{isShowDialog:i,categoryNames:v,curCategory:u,images:c,searchByName:o,current:r,columns:zl,confirmDelete:n,removeImage:y,closeDialog:_,update:async p=>{console.log(p)}}}}),Wl=e=>(Qt("data-v-171efa3b"),e=e(),Ut(),e),Gl=Wl(()=>B("div",{class:"flex items-center q-mb-sm"},null,-1)),Jl={class:"full-width"},Xl={class:"row"},Yl={class:"row justify-end"},Zl={class:"flex justify-end item-control"},ea={class:"q-gutter-xs"};function ta(e,l,a,v,u,i){const o=Re("ConfirmDialog");return z(),ne(Mt,null,[Gl,B("div",Jl,[k(Hl,{flat:"",bordered:"","virtual-scroll":"",rows:e.images(e.curCategory,e.searchByName),columns:e.columns,"row-key":"name"},{"body-cell-content":O(r=>[k(Ge,{props:r},{default:O(()=>[B("div",Xl,[k(at,{class:"q-mt-xs",src:r.value,"spinner-color":"white",style:{height:"70px","max-width":"70px"}},null,8,["src"])])]),_:2},1032,["props"])]),"body-cell-descriptor":O(r=>[k(Ge,{props:r},{default:O(()=>[B("div",Yl,[B("div",Zl,[B("div",ea,[k(N,{class:"q-mr-sm",size:"12px",flat:"",dense:"",round:"",icon:"delete",onClick:c=>e.confirmDelete(r.row.id)},null,8,["onClick"])])])])]),_:2},1032,["props"])]),"top-left":O(()=>[k(Te,{debounce:"300",outlined:"",modelValue:e.searchByName,"onUpdate:modelValue":l[0]||(l[0]=r=>e.searchByName=r),label:"\u041F\u043E\u0438\u0441\u043A \u043F\u043E \u0438\u043C\u0435\u043D\u0438"},null,8,["modelValue"])]),_:1},8,["rows","columns"])]),k(o,{isShow:e.isShowDialog,message:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0432\u044B\u0431\u0440\u0430\u043D\u043D\u0443\u044E \u0437\u0430\u043F\u0438\u0441\u044C?",onOk:e.removeImage,onCancel:e.closeDialog},null,8,["isShow","onOk","onCancel"])],64)}var la=Ve(Kl,[["render",ta],["__scopeId","data-v-171efa3b"]]);const aa=xe({name:"ImagesPage",components:{ImageCategoryAdd:Cl,ImagesList:la},setup(){const e=R(null),l=R(""),a=R(""),v=R(""),u=R(!1),i=lt(),o=Oe(),{defaultCategory:r,categoryNames:c}=re(o);v.value=r.value.name;const{imagesList:g,placeholderUrl:n}=re(i),y=ot();return i.getImages(),{imagesList:g,image:e,imageUrl:l,name:a,isShowDialog:u,placeholderUrl:n,category:v,categoryNames:c,failed:async m=>{y.error(JSON.parse(m.xhr.responseText).message)},handleUpload:async()=>{if(e.value){const m=await oa(e.value);l.value=m}},save:async()=>{if(e.value){const m={record:{name:a.value,content:l.value,category:v.value},fileName:e.value.name};await i.insert(m),a.value=""}}}}}),oa=e=>new Promise(function(l,a){if(!(e instanceof Blob))return a("bufferToImage - expected buf to be of type: Blob");var v=new FileReader;v.onload=function(){return typeof v.result!="string"?a("bufferToImage - expected reader.result to be a string, in onload"):l(v.result)},v.onerror=a,v.readAsDataURL(e)}),na={class:"row justify-between items-start full-width"},ra={class:"row justify-start q-pa-md full-width q-col-gutter-md"},ua={class:"col-md-6 col-12"},sa={class:"flex justify-between items-center"},ia={class:"col-md-6 col-12 flex justify-center"},ca=["src"],da={class:"full-width flex justify-center q-px-lg"},va={key:0},fa={key:1,class:"full-width flex justify-start wrap"};function ma(e,l,a,v,u,i){const o=Re("ImagesList"),r=Re("ImageCategoryAdd");return z(),ze(rl,null,{default:O(()=>[B("div",na,[B("section",ra,[B("div",ua,[k(fl,{class:"full-width",outlined:"","bottom-slots":"",modelValue:e.image,"onUpdate:modelValue":[l[1]||(l[1]=c=>e.image=c),e.handleUpload],counter:"","max-files":"1",label:"\u0412\u044B\u0431\u043E\u0440 \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u044F",accept:".jpg, .jpeg, .png"},{hint:O(()=>[Ke(" \u0420\u0430\u0437\u043C\u0435\u0440 ")]),append:O(()=>[Ht(k(De,{name:"close",onClick:l[0]||(l[0]=Kt(c=>e.image=null,["stop","prevent"])),class:"cursor-pointer"},null,512),[[zt,e.image!==null]])]),_:1},8,["modelValue","onUpdate:modelValue"]),k(Te,{outlined:"",class:"q-my-md",label:"\u0418\u043C\u044F",modelValue:e.name,"onUpdate:modelValue":l[2]||(l[2]=c=>e.name=c),style:{padding:"0"}},null,8,["modelValue"]),B("div",sa,[k(tt,{style:{width:"85%",padding:"0"},"bottom-slots":"",modelValue:e.category,"onUpdate:modelValue":l[3]||(l[3]=c=>e.category=c),options:e.categoryNames,label:"\u041A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u044F",outlined:""},null,8,["modelValue","options"]),k(N,{round:"",color:"primary",icon:"add",onClick:l[4]||(l[4]=c=>e.isShowDialog=!0)})]),k(N,{onClick:e.save,class:"q-mt-md",color:"primary",rounded:"",disable:e.image===null||e.name===""},{default:O(()=>[Ke("\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0432 \u0431\u0430\u0437\u0443")]),_:1},8,["onClick","disable"])]),B("div",ia,[e.image?(z(),ze(at,{key:1,src:e.imageUrl,"spinner-color":"white",style:{height:"300px","max-width":"300px"},fit:"cover"},null,8,["src"])):(z(),ne("img",{key:0,width:"250",src:e.placeholderUrl},null,8,ca))])]),B("section",da,[e.imagesList.length===0?(z(),ne("h6",va,"\u0421\u043F\u0438\u0441\u043E\u043A \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0439 \u043F\u0443\u0441\u0442")):(z(),ne("div",fa,[k(o,{category:e.category},null,8,["category"])]))])]),k(r,{isShow:e.isShowDialog,onClose:l[5]||(l[5]=c=>e.isShowDialog=!1)},null,8,["isShow"])]),_:1})}var Ia=Ve(aa,[["render",ma]]);export{Ia as default};
